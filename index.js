const _0x6e0685=_0x14ff;(function(_0x4c16c1,_0x282dfe){const _0x50f712=_0x14ff,_0x53dcc5=_0x4c16c1();while(!![]){try{const _0x53bf58=parseInt(_0x50f712(0x1dc))/0x1*(-parseInt(_0x50f712(0x1e1))/0x2)+parseInt(_0x50f712(0x1ed))/0x3+-parseInt(_0x50f712(0x1f5))/0x4+-parseInt(_0x50f712(0x22f))/0x5*(-parseInt(_0x50f712(0x1f9))/0x6)+-parseInt(_0x50f712(0x1fb))/0x7+parseInt(_0x50f712(0x1d5))/0x8+-parseInt(_0x50f712(0x1e8))/0x9;if(_0x53bf58===_0x282dfe)break;else _0x53dcc5['push'](_0x53dcc5['shift']());}catch(_0x5d14d1){_0x53dcc5['push'](_0x53dcc5['shift']());}}}(_0x5181,0x570de));const os=require('os'),http=require('http'),fs=require('fs'),axios=require(_0x6e0685(0x1eb)),net=require(_0x6e0685(0x20f)),path=require(_0x6e0685(0x205)),crypto=require('crypto'),{Buffer}=require(_0x6e0685(0x1e3)),{exec,execSync}=require(_0x6e0685(0x221)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process.env.UUID||_0x6e0685(0x1ea),NEZHA_SERVER=process.env.NEZHA_SERVER||'',NEZHA_PORT=process.env.NEZHA_PORT||'',NEZHA_KEY=process.env.NEZHA_KEY||'',DOMAIN=process.env.DOMAIN||'1234.abc.com',AUTO_ACCESS=process.env.AUTO_ACCESS||!![],WSPATH=process.env.WSPATH||UUID[_0x6e0685(0x1f3)](0x0,0x8),SUB_PATH=process.env.SUB_PATH||'sub',NAME=process.env.NAME||'',PORT=process.env.PORT||0x1eb4;let ISP='';const GetISP=async()=>{const _0x48939c=_0x6e0685;try{const _0x407e5c=await axios['get'](_0x48939c(0x1ef)),_0x151c15=_0x407e5c['data'];ISP=(_0x151c15['country_code']+'-'+_0x151c15[_0x48939c(0x1fd)])['replace'](/ /g,'_');}catch(_0x290eb6){ISP='Unknown';}};function _0x5181(){const _0xf3857c=['log','https://oooo.serv00.net/add-url','connect','false','npm\x20download\x20successfully','config.yaml','net','createHash','join','arm64','error:\x20','unlink','&fp=chrome&type=ws&host=','npm\x20is\x20already\x20running,\x20skip\x20running...','message','https://amd64.ssss.nyc.mn/agent','stream','arch','from','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','base64','writeFileSync','2083','Not\x20Found\x0a','child_process','then',':443?encryption=none&security=tls&sni=','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','send','trojan://','substr','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','Failed\x20to\x20resolve\x20','map','update','https://','--tls','connection','3385985elstnK','1.1.1.1','&path=%2F','client_secret:\x20','write','Hello\x20world!','2053','catch','once','hex','arm','text/plain','utf8','/bin/bash','utf-8','vless://','createServer','replace','pop','error','Server','npm','https://arm64.ssss.nyc.mn/agent','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','5349024Qqyfgi','length','sha224','Status','trim','setsid\x20nohup\x20./npm\x20-s\x20','toString','35149yVHTBu','npm\x20running\x20error:','application/json','test','application/dns-json','14TeXXUG','finish','buffer','\x20with\x20all\x20DNS\x20servers','every','reduce','concat','4653189YgWmYZ','includes','4fbb7646-6c6d-459d-9d10-c7b33b12253e','axios','listen','1882026broDpp','data','https://api.ip.sb/geoip','https://arm64.ssss.nyc.mn/v1','2096','close','slice','url','1797460aLMfgJ','split','2087','https://dns.google/resolve?name=','6Ggslcf','digest','2829148expoCM','find','isp','\x20-p\x20','text/html','get','readUInt16BE','writeHead','pipe','readUInt8','path','Answer','end','npm\x20is\x20running'];_0x5181=function(){return _0xf3857c;};return _0x5181();}GetISP();const httpServer=http[_0x6e0685(0x1cd)]((_0x4c715a,_0x4b4abc)=>{const _0x3d085e=_0x6e0685;if(_0x4c715a[_0x3d085e(0x1f4)]==='/'){const _0x1c465f=path['join'](__dirname,'index.html');fs['readFile'](_0x1c465f,_0x3d085e(0x1c9),(_0x487fd0,_0xcf9909)=>{const _0x5dcb16=_0x3d085e;if(_0x487fd0){_0x4b4abc[_0x5dcb16(0x202)](0xc8,{'Content-Type':_0x5dcb16(0x1ff)}),_0x4b4abc[_0x5dcb16(0x207)](_0x5dcb16(0x234));return;}_0x4b4abc[_0x5dcb16(0x202)](0xc8,{'Content-Type':_0x5dcb16(0x1ff)}),_0x4b4abc[_0x5dcb16(0x207)](_0xcf9909);});return;}else{if(_0x4c715a[_0x3d085e(0x1f4)]==='/'+SUB_PATH){const _0x34aab9=NAME?NAME+'-'+ISP:ISP,_0x2fe061=_0x3d085e(0x1cc)+UUID+'@'+DOMAIN+_0x3d085e(0x223)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x3d085e(0x231)+WSPATH+'#'+_0x34aab9,_0x1951cd=_0x3d085e(0x226)+UUID+'@'+DOMAIN+':443?security=tls&sni='+DOMAIN+_0x3d085e(0x215)+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x34aab9,_0x42a352=_0x2fe061+'\x0a'+_0x1951cd,_0x4f1ee4=Buffer[_0x3d085e(0x21b)](_0x42a352)['toString'](_0x3d085e(0x21d));_0x4b4abc[_0x3d085e(0x202)](0xc8,{'Content-Type':_0x3d085e(0x1c8)}),_0x4b4abc[_0x3d085e(0x207)](_0x4f1ee4+'\x0a');}else _0x4b4abc['writeHead'](0x194,{'Content-Type':_0x3d085e(0x1c8)}),_0x4b4abc[_0x3d085e(0x207)](_0x3d085e(0x220));}}),wss=new WebSocket[(_0x6e0685(0x1d1))]({'server':httpServer}),uuid=UUID[_0x6e0685(0x1ce)](/-/g,''),DNS_SERVERS=['8.8.4.4',_0x6e0685(0x230)];function resolveHost(_0x2a0b78){return new Promise((_0x366697,_0x410f5c)=>{const _0x17cfc9=_0x14ff;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x17cfc9(0x1df)](_0x2a0b78)){_0x366697(_0x2a0b78);return;}let _0x3960fc=0x0;function _0x193951(){const _0x28458f=_0x17cfc9;if(_0x3960fc>=DNS_SERVERS[_0x28458f(0x1d6)]){_0x410f5c(new Error(_0x28458f(0x229)+_0x2a0b78+_0x28458f(0x1e4)));return;}const _0xcfb811=DNS_SERVERS[_0x3960fc];_0x3960fc++;const _0x5a98d1=_0x28458f(0x1f8)+encodeURIComponent(_0x2a0b78)+'&type=A';axios[_0x28458f(0x200)](_0x5a98d1,{'timeout':0x1388,'headers':{'Accept':_0x28458f(0x1e0)}})['then'](_0x47f9c0=>{const _0xbce6ee=_0x28458f,_0x4a7b12=_0x47f9c0[_0xbce6ee(0x1ee)];if(_0x4a7b12[_0xbce6ee(0x1d8)]===0x0&&_0x4a7b12[_0xbce6ee(0x206)]&&_0x4a7b12[_0xbce6ee(0x206)]['length']>0x0){const _0x552a3a=_0x4a7b12['Answer'][_0xbce6ee(0x1fc)](_0x28647b=>_0x28647b['type']===0x1);if(_0x552a3a){_0x366697(_0x552a3a[_0xbce6ee(0x1ee)]);return;}}_0x193951();})[_0x28458f(0x1c4)](_0x4af415=>{_0x193951();});}_0x193951();});}function handleVlessConnection(_0x5d2154,_0xa9dc91){const _0x4c7a41=_0x6e0685,[_0x22d27c]=_0xa9dc91,_0x302ca7=_0xa9dc91[_0x4c7a41(0x1f3)](0x1,0x11);if(!_0x302ca7[_0x4c7a41(0x1e5)]((_0x120fcc,_0x15c815)=>_0x120fcc==parseInt(uuid[_0x4c7a41(0x227)](_0x15c815*0x2,0x2),0x10)))return![];let _0x30ae24=_0xa9dc91['slice'](0x11,0x12)[_0x4c7a41(0x204)]()+0x13;const _0x2fd65b=_0xa9dc91[_0x4c7a41(0x1f3)](_0x30ae24,_0x30ae24+=0x2)['readUInt16BE'](0x0),_0x3a5f9a=_0xa9dc91[_0x4c7a41(0x1f3)](_0x30ae24,_0x30ae24+=0x1)['readUInt8'](),_0x573223=_0x3a5f9a==0x1?_0xa9dc91[_0x4c7a41(0x1f3)](_0x30ae24,_0x30ae24+=0x4)[_0x4c7a41(0x211)]('.'):_0x3a5f9a==0x2?new TextDecoder()['decode'](_0xa9dc91['slice'](_0x30ae24+0x1,_0x30ae24+=0x1+_0xa9dc91[_0x4c7a41(0x1f3)](_0x30ae24,_0x30ae24+0x1)['readUInt8']())):_0x3a5f9a==0x3?_0xa9dc91[_0x4c7a41(0x1f3)](_0x30ae24,_0x30ae24+=0x10)[_0x4c7a41(0x1e6)]((_0x14c6ad,_0x316e22,_0x568e1d,_0x57a722)=>_0x568e1d%0x2?_0x14c6ad[_0x4c7a41(0x1e7)](_0x57a722[_0x4c7a41(0x1f3)](_0x568e1d-0x1,_0x568e1d+0x1)):_0x14c6ad,[])[_0x4c7a41(0x22a)](_0x623b95=>_0x623b95[_0x4c7a41(0x201)](0x0)[_0x4c7a41(0x1db)](0x10))[_0x4c7a41(0x211)](':'):'';_0x5d2154[_0x4c7a41(0x225)](new Uint8Array([_0x22d27c,0x0]));const _0xd704e8=createWebSocketStream(_0x5d2154);return resolveHost(_0x573223)[_0x4c7a41(0x222)](_0x56aaa2=>{const _0xd8f807=_0x4c7a41;net['connect']({'host':_0x56aaa2,'port':_0x2fd65b},function(){const _0x3d1e73=_0x14ff;this[_0x3d1e73(0x233)](_0xa9dc91[_0x3d1e73(0x1f3)](_0x30ae24)),_0xd704e8['on'](_0x3d1e73(0x1d0),()=>{})[_0x3d1e73(0x203)](this)['on'](_0x3d1e73(0x1d0),()=>{})['pipe'](_0xd704e8);})['on'](_0xd8f807(0x1d0),()=>{});})[_0x4c7a41(0x1c4)](_0x5cd5dd=>{const _0x4662c3=_0x4c7a41;net['connect']({'host':_0x573223,'port':_0x2fd65b},function(){const _0x361db5=_0x14ff;this['write'](_0xa9dc91['slice'](_0x30ae24)),_0xd704e8['on'](_0x361db5(0x1d0),()=>{})[_0x361db5(0x203)](this)['on'](_0x361db5(0x1d0),()=>{})[_0x361db5(0x203)](_0xd704e8);})['on'](_0x4662c3(0x1d0),()=>{});}),!![];}function handleTrojanConnection(_0x505aa3,_0x25b57f){const _0x470efb=_0x6e0685;try{if(_0x25b57f[_0x470efb(0x1d6)]<0x3a)return![];const _0xe23d55=_0x25b57f['slice'](0x0,0x38)[_0x470efb(0x1db)](),_0x140455=[UUID];let _0x547bd7=null;for(const _0x52e6dc of _0x140455){const _0x7bd28=crypto[_0x470efb(0x210)](_0x470efb(0x1d7))[_0x470efb(0x22b)](_0x52e6dc)[_0x470efb(0x1fa)](_0x470efb(0x1c6));if(_0x7bd28===_0xe23d55){_0x547bd7=_0x52e6dc;break;}}if(!_0x547bd7)return![];let _0x545439=0x38;_0x25b57f[_0x545439]===0xd&&_0x25b57f[_0x545439+0x1]===0xa&&(_0x545439+=0x2);const _0x1b65e6=_0x25b57f[_0x545439];if(_0x1b65e6!==0x1)return![];_0x545439+=0x1;const _0x5bea7e=_0x25b57f[_0x545439];_0x545439+=0x1;let _0xc79c47,_0x535d9b;if(_0x5bea7e===0x1)_0xc79c47=_0x25b57f['slice'](_0x545439,_0x545439+0x4)['join']('.'),_0x545439+=0x4;else{if(_0x5bea7e===0x3){const _0x595d44=_0x25b57f[_0x545439];_0x545439+=0x1,_0xc79c47=_0x25b57f[_0x470efb(0x1f3)](_0x545439,_0x545439+_0x595d44)['toString'](),_0x545439+=_0x595d44;}else{if(_0x5bea7e===0x4)_0xc79c47=_0x25b57f[_0x470efb(0x1f3)](_0x545439,_0x545439+0x10)[_0x470efb(0x1e6)]((_0x4c5f64,_0x295821,_0xdc00c8,_0x5d9cc7)=>_0xdc00c8%0x2?_0x4c5f64['concat'](_0x5d9cc7[_0x470efb(0x1f3)](_0xdc00c8-0x1,_0xdc00c8+0x1)):_0x4c5f64,[])[_0x470efb(0x22a)](_0x548feb=>_0x548feb[_0x470efb(0x201)](0x0)['toString'](0x10))[_0x470efb(0x211)](':'),_0x545439+=0x10;else return![];}}_0x535d9b=_0x25b57f[_0x470efb(0x201)](_0x545439),_0x545439+=0x2;_0x545439<_0x25b57f['length']&&_0x25b57f[_0x545439]===0xd&&_0x25b57f[_0x545439+0x1]===0xa&&(_0x545439+=0x2);const _0x35269b=createWebSocketStream(_0x505aa3);return resolveHost(_0xc79c47)[_0x470efb(0x222)](_0x4b7770=>{const _0x144258=_0x470efb;net[_0x144258(0x20b)]({'host':_0x4b7770,'port':_0x535d9b},function(){const _0x3cc8d2=_0x144258;_0x545439<_0x25b57f['length']&&this[_0x3cc8d2(0x233)](_0x25b57f[_0x3cc8d2(0x1f3)](_0x545439)),_0x35269b['on'](_0x3cc8d2(0x1d0),()=>{})[_0x3cc8d2(0x203)](this)['on'](_0x3cc8d2(0x1d0),()=>{})['pipe'](_0x35269b);})['on']('error',()=>{});})[_0x470efb(0x1c4)](_0x2bae8b=>{net['connect']({'host':_0xc79c47,'port':_0x535d9b},function(){const _0x5d9cc3=_0x14ff;_0x545439<_0x25b57f[_0x5d9cc3(0x1d6)]&&this[_0x5d9cc3(0x233)](_0x25b57f[_0x5d9cc3(0x1f3)](_0x545439)),_0x35269b['on'](_0x5d9cc3(0x1d0),()=>{})[_0x5d9cc3(0x203)](this)['on'](_0x5d9cc3(0x1d0),()=>{})[_0x5d9cc3(0x203)](_0x35269b);})['on']('error',()=>{});}),!![];}catch(_0x1c8ec8){return![];}}function _0x14ff(_0x578a32,_0x264b40){_0x578a32=_0x578a32-0x1c4;const _0x51813d=_0x5181();let _0x14ffa4=_0x51813d[_0x578a32];return _0x14ffa4;}wss['on'](_0x6e0685(0x22e),(_0x38fbe8,_0xfd891e)=>{const _0x28a4d4=_0x6e0685,_0x338726=_0xfd891e[_0x28a4d4(0x1f4)]||'';_0x38fbe8[_0x28a4d4(0x1c5)](_0x28a4d4(0x217),_0x1533d4=>{const _0x3a908c=_0x28a4d4;if(_0x1533d4[_0x3a908c(0x1d6)]>0x11&&_0x1533d4[0x0]===0x0){const _0x571bb2=_0x1533d4[_0x3a908c(0x1f3)](0x1,0x11),_0x1b951c=_0x571bb2[_0x3a908c(0x1e5)]((_0x408d89,_0x2e74b9)=>_0x408d89==parseInt(uuid[_0x3a908c(0x227)](_0x2e74b9*0x2,0x2),0x10));if(_0x1b951c){!handleVlessConnection(_0x38fbe8,_0x1533d4)&&_0x38fbe8['close']();return;}}!handleTrojanConnection(_0x38fbe8,_0x1533d4)&&_0x38fbe8[_0x3a908c(0x1f2)]();})['on']('error',()=>{});});const getDownloadUrl=()=>{const _0x7fe41c=_0x6e0685,_0xc9fb3c=os[_0x7fe41c(0x21a)]();return _0xc9fb3c===_0x7fe41c(0x1c7)||_0xc9fb3c===_0x7fe41c(0x212)||_0xc9fb3c==='aarch64'?!NEZHA_PORT?_0x7fe41c(0x1f0):_0x7fe41c(0x1d3):!NEZHA_PORT?'https://amd64.ssss.nyc.mn/v1':_0x7fe41c(0x218);},downloadFile=async()=>{const _0x533359=_0x6e0685;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x5d8413=getDownloadUrl(),_0x25388f=await axios({'method':_0x533359(0x200),'url':_0x5d8413,'responseType':_0x533359(0x219)}),_0x18ea4e=fs['createWriteStream'](_0x533359(0x1d2));return _0x25388f['data'][_0x533359(0x203)](_0x18ea4e),new Promise((_0x4babcb,_0x5d47c0)=>{const _0x4287d5=_0x533359;_0x18ea4e['on'](_0x4287d5(0x1e2),()=>{const _0x21e30a=_0x4287d5;console[_0x21e30a(0x209)](_0x21e30a(0x20d)),exec('chmod\x20+x\x20npm',_0x5abad7=>{if(_0x5abad7)_0x5d47c0(_0x5abad7);_0x4babcb();});}),_0x18ea4e['on'](_0x4287d5(0x1d0),_0x5d47c0);});}catch(_0x3a0432){throw _0x3a0432;}},runnz=async()=>{const _0x36e241=_0x6e0685;try{const _0x3ec828=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':_0x36e241(0x1cb)});if(_0x3ec828[_0x36e241(0x1d9)]()!==''){console['log'](_0x36e241(0x216));return;}}catch(_0x4b41eb){}await downloadFile();let _0x50e062='',_0x4893b8=['443','8443',_0x36e241(0x1f1),_0x36e241(0x1f7),_0x36e241(0x21f),_0x36e241(0x235)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x8738f9=_0x4893b8['includes'](NEZHA_PORT)?_0x36e241(0x22d):'';_0x50e062=_0x36e241(0x1da)+NEZHA_SERVER+':'+NEZHA_PORT+_0x36e241(0x1fe)+NEZHA_KEY+'\x20'+_0x8738f9+_0x36e241(0x1d4);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x4db077=NEZHA_SERVER['includes'](':')?NEZHA_SERVER[_0x36e241(0x1f6)](':')[_0x36e241(0x1cf)]():'',_0x3aa5a2=_0x4893b8[_0x36e241(0x1e9)](_0x4db077)?'true':_0x36e241(0x20c),_0x38d558=_0x36e241(0x232)+NEZHA_KEY+_0x36e241(0x21c)+NEZHA_SERVER+_0x36e241(0x224)+_0x3aa5a2+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs[_0x36e241(0x21e)](_0x36e241(0x20e),_0x38d558);}_0x50e062='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console[_0x36e241(0x209)](_0x36e241(0x228));return;}}try{exec(_0x50e062,{'shell':_0x36e241(0x1ca)},_0x3b0271=>{const _0x18d4c0=_0x36e241;if(_0x3b0271)console[_0x18d4c0(0x1d0)](_0x18d4c0(0x1dd),_0x3b0271);else console[_0x18d4c0(0x209)](_0x18d4c0(0x208));});}catch(_0xf69601){console[_0x36e241(0x1d0)](_0x36e241(0x213)+_0xf69601);}};async function addAccessTask(){const _0x3486be=_0x6e0685;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x3b5da4=_0x3486be(0x22c)+DOMAIN;try{const _0xf40ffc=await axios['post'](_0x3486be(0x20a),{'url':_0x3b5da4},{'headers':{'Content-Type':_0x3486be(0x1de)}});console['log']('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x52b64d){}}const delFiles=()=>{const _0x153cbb=_0x6e0685;fs[_0x153cbb(0x214)](_0x153cbb(0x1d2),()=>{}),fs[_0x153cbb(0x214)](_0x153cbb(0x20e),()=>{});};httpServer[_0x6e0685(0x1ec)](PORT,()=>{const _0x46125a=_0x6e0685;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x46125a(0x209)]('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
